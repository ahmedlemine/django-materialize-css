{% extends 'base.html' %}
{% load humanize %}

{% block content %}

<div class="row">
  <div class="col s12">
    <div class="input-field">
      <input type="text" name="q"
        hx-get="/search"
        hx-trigger="keyup changed delay:100ms"
        hx-target="#search-results"
        hx-swap="innerHTML"
        placeholder="Search..."
      >
    </div>
    <div id="search-results" class="scale-transition scale-in">
    </div>
  </div>
</div>

<div class="row">
  <div class="col s12">
    <H3 class="purple-text text-darken-3">Latest Posts
      {% if user.is_authenticated %}
      <span>
        <button hx-get="{% url 'posts:htmx-create' %}"
        hx-target="#post-list-template"
        hx-swap="outerHtml"
        class="waves-effect waves-light btn-small indigo lighten-1">
        Add a post</button>
      </span>
      {% endif %}
    </H3>
  </div>
</div>

<!-- htmx target for create form -->
<div id="post-add-form"></div>

<div id="post-list-template">

{% include 'posts/_post_list.html' %}

</div>
<div class="col s12 m6">
<section>
  <ul class="collection with-header">
    <li class="collection-header"><h4>Popular Posts</h4></li>
    {% for post in popular_posts %}
      <li class="collection-item">
        <a href="{% url 'posts:detail' post.slug %}">{{ post.title }}
        </a></li>
    {% endfor %}
  </ul>
</section>
</div>
<br>
<!-- floating action buttons -->
<div class="fixed-action-btn">
    <a class="btn-floating btn-large purple darken-3">
      <i class="large material-icons">add</i>
    </a>
    <ul>
      <li><a class="btn-floating yellow darken-1"><i class="material-icons">format_quote</i></a></li>
      <li><a class="btn-floating green"><i class="material-icons">publish</i></a></li>
      <li><a class="btn-floating blue"><i class="material-icons">attach_file</i></a></li>
      <li><a href="{% url 'posts:create' %}" class="btn-floating modal-trigger red">
          <i class="material-icons">add</i></a>
        </li>
    </ul>
  </div>

{% endblock content %}