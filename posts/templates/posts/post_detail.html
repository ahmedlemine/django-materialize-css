{% extends 'base.html' %}
{% load static %}
{% load hitcount_tags %}
{% load humanize %}

{% block content %}
<div class="section">
<h1 class="flow-text purple-text text-darken-3">{{ post.title }}</h1>
  <div class="">
    <img class="materialboxed responsive-img" src="{{ post.image.url }}">
  </div>



<div class="valign-wrapper grey-text section">

  <img src="{{ post.creator.userprofile.avatar.url }}"
    width="50" height="50"
    alt="{{post.creator.userprofile.name}} avatar"
    class="circle responsive-img">

        <span>&nbsp;&nbsp;{{ post.creator.userprofile.name }}&nbsp;&nbsp;|
        <span>&nbsp;{{ post.added|timesince }} ago &nbsp;
         |&nbsp; {% get_hit_count for post %} views</span>
        <span>&nbsp;&nbsp;&nbsp;</span>

</div>
{% if user.is_authenticated and post.creator == user %}

<div id="post-actions">
  <a href="{% url 'posts:update' post.slug %}"
  class="btn waves-effect waves-light teal">
    <i class="material-icons">edit</i></a>
  <a href="#post-delete-modal"
    class="btn waves-effect waves-light red modal-trigger">
    <i class="material-icons tiny">delete</i></a>
</div>
{% endif %}

<hr class="grey-text text-lighten-4">
<p class="flow-text">{{ post.body }}</p>
</div>
{% if popular_posts %}
  {% include 'posts/_popular_posts.html' %}
{% endif %}

 <!-- delete post Modal -->
 <div id="post-delete-modal" class="modal">
  <div class="modal-content">
    <H5 class="flow-text purple-text darken-3"">Delete Post</H5>
    <p class="">Are you sure you want to delete this post
        <span class="teal-text"> {{ post.title }}</span></hp>

        <form action="{% url 'posts:delete' post.slug %}" method='POST' class="col s12">
            {% csrf_token %}
            <button class="btn waves-effect waves-light red center"
                type="submit" name="action">Yes, Delete
                <i class="material-icons left">delete</i>
            </button>
        </form>
    </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">
      Cancel</a>
  </div>
</div>
<!-- end modal -->    
{% endblock content %}

{% block script %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
      let mboxed = document.querySelectorAll('.materialboxed')
      let instances = M.Materialbox.init(mboxed, {})
    })
</script>

{% endblock script %}